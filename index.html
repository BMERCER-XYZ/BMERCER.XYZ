<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BMERCER.XYZ</title>
  <style>
    :root{
      color-scheme: dark;
      --bg:#0b0b10;--fg:#eaeaea;--muted:#8a8f98;--accent:#bd64f8;--card:#141518;--border:#26282d;
    }
    html,body{height:100%; overflow:hidden;}
    body{margin:0;background:var(--bg);color:var(--fg);font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;display:flex;flex-direction:column;}
    #banner{padding:60px; text-align:center; position:relative; z-index:1;}
    
      /* Dynamic ASCII title sizing */
      #banner .ascii-title{
        --ascii-cols: 160;
        --ascii-container-w: min(100vw, 100vw);
        --ascii-padding: 120px; /* banner has padding-left/right 60px each */
        --ascii-max-font: 14px;
        /* scale lets you bump size without changing layout math */
        --banner-scale: 1.7;
        font-size: min(calc(((var(--ascii-container-w) - var(--ascii-padding)) / var(--ascii-cols)) * var(--banner-scale)), var(--ascii-max-font));
        white-space: pre;
        line-height: 0.9;
        color: var(--fg);
        font-weight: bold;
        display: inline-block;
        text-align: center;
        margin: 0;
      }
    .screen-wrap{
      flex:1;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      position: relative;
      z-index:1;
    }
    
    .nav-buttons {
      position: fixed;
      top: 400px;
      left: 250px;
      right: 250px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      pointer-events: none;
      z-index: 10;
    }
    
    .nav-button {
      background: var(--card);
      border: 2px solid var(--border);
      color: var(--fg);
      padding: 20px 50px;
      border-radius: 8px;
      font-family: inherit;
      font-size: 25px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      pointer-events: auto;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .nav-button:hover {
      background: var(--fg);
      color: var(--bg);
      transform: translateY(-2px);
    }
    
    .nav-button:active {
      transform: translateY(0);
    }
    pre#screen{
      margin:0;
      padding:0;
      white-space:pre;
      line-height:1.05;
      tab-size:2;
  text-align:left;
      display:inline-block;
      vertical-align:middle;
      /* dynamic sizing driven by ascii-fit.js */
      --ascii-cols: 160; /* fallback */
      --ascii-rows: 60;  /* fallback, if needed */
      --ascii-container-w: 100vw;
      --ascii-container-h: 100vh;
      --screen-padding: 32px; /* padding left+right */
      --screen-max-font: 10px; /* cap font size */
      /* choose the limiting dimension: width-based char width and height-based char height */
      /* Estimate row height as 1ch*line-height; use width constraint primarily to avoid overflow */
      font-size: min(calc(((var(--ascii-container-w) - var(--screen-padding)) / var(--ascii-cols)) * var(--screen-scale, 1.7)), var(--screen-max-font));
    }
    
    
    /* Scaling for mobile */
    @media (max-width: 800px) {
      html, body {
        display: grid;
        grid-template-rows: auto auto;
        height: 100vh;
        overflow: hidden;
        position: fixed;
        width: 100%;
        touch-action: none;
        -webkit-overflow-scrolling: touch;
      }
      #banner {
        display: block;
        grid-row: 1;
        padding: 10px 5px;
        padding-top: 50px;
        line-height: 0.7;
        /* allow the ASCII to define its own height */
        overflow: visible;
      }
      /* Fit banner ASCII to viewport width exactly (201 columns) */
      #banner .ascii-title{
        --banner-cols: 125;                  /* fixed columns for this banner */
        --banner-pad-x: 10px;                /* banner padding-left+right (5+5) */
        --banner-fudge: 2px;                 /* small safety to avoid subpixel overflow */
        font-size: calc((100vw - var(--banner-pad-x) - var(--banner-fudge)) / var(--banner-cols));
      }
      .screen-wrap {
        display: none;
      }
      .nav-buttons {
        grid-row: 2;
        display: flex;
        left: 0;
        right: 0;
        flex-direction: column;
        gap: 20px;
        width: 100%;
        align-items: stretch;
        padding: 0 15px;
        box-sizing: border-box;
        margin: 8px auto 24px;
      }
      .nav-button {
        width: 100%;
        padding: 20px 30px;
        font-size: 20px;
        box-sizing: border-box;
      }
    }
    


  </style>
</head>
<body>

  <div id="banner">
  <pre class="ascii-title" data-col-buffer="0">
__/\\\\\\\\\\\\\____/\\\\____________/\\\\__/\\\\\\\\\\\\\\\____/\\\\\\\\\____________/\\\\\\\\\__/\\\\\\\\\\\\\\\____/\\\\\\\\\____________/\\\_______/\\\__/\\\________/\\\__/\\\\\\\\\\\\\\\_        
 _\/\\\/////////\\\_\/\\\\\\________/\\\\\\_\/\\\///////////___/\\\///////\\\_______/\\\////////__\/\\\///////////___/\\\///////\\\_________\///\\\___/\\\/__\///\\\____/\\\/__\////////////\\\__       
  _\/\\\_______\/\\\_\/\\\//\\\____/\\\//\\\_\/\\\_____________\/\\\_____\/\\\_____/\\\/___________\/\\\_____________\/\\\_____\/\\\___________\///\\\\\\/______\///\\\/\\\/______________/\\\/___      
   _\/\\\\\\\\\\\\\\__\/\\\\///\\\/\\\/_\/\\\_\/\\\\\\\\\\\_____\/\\\\\\\\\\\/_____/\\\_____________\/\\\\\\\\\\\_____\/\\\\\\\\\\\/______________\//\\\\__________\///\\\/______________/\\\/_____     
    _\/\\\/////////\\\_\/\\\__\///\\\/___\/\\\_\/\\\///////______\/\\\//////\\\____\/\\\_____________\/\\\///////______\/\\\//////\\\_______________\/\\\\____________\/\\\_____________/\\\/_______    
     _\/\\\_______\/\\\_\/\\\____\///_____\/\\\_\/\\\_____________\/\\\____\//\\\___\//\\\____________\/\\\_____________\/\\\____\//\\\______________/\\\\\\___________\/\\\___________/\\\/_________   
      _\/\\\_______\/\\\_\/\\\_____________\/\\\_\/\\\_____________\/\\\_____\//\\\___\///\\\__________\/\\\_____________\/\\\_____\//\\\___________/\\\////\\\_________\/\\\_________/\\\/___________  
       _\/\\\\\\\\\\\\\/__\/\\\_____________\/\\\_\/\\\\\\\\\\\\\\\_\/\\\______\//\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\_\/\\\______\//\\\__/\\\__/\\\/___\///\\\_______\/\\\________/\\\\\\\\\\\\\\\_ 
        _\/////////////____\///______________\///__\///////////////__\///________\///________\/////////__\///////////////__\///________\///__\///__\///_______\///________\///________\///////////////__
      </pre>
      <script src="/projects/ascii-fit.js"></script>
    </div>
  <div class="screen-wrap">
    <pre id="screen">Loading...</pre>
  </div>

  <div class="nav-buttons">
    <a href="/projects" class="nav-button">PROJECTS</a>
    <a href="/about" class="nav-button">ABOUT</a>
  </div>


  <script>
    (function(){
      const screenEl = document.getElementById('screen');
      const mobileQuery = window.matchMedia('(max-width: 800px)');
  let screenFitHandle = null;
  let desktopCtrl = null;

      const params = new URLSearchParams(location.search);
      const DESKTOP_TOTAL_FRAMES = 300;
      const DESKTOP_SPEED = 0.5;
      const DESKTOP_FOLDER = 'ACII-Frames';
      const DESKTOP_PREFIX = '';
      const DESKTOP_PAD = 4;
      const DESKTOP_EXT = '.txt';
      const DESKTOP_FPS = Number(params.get('fps') || 60);

      function initDesktopAnimation(){
        if (!screenEl) return null;

        const frames = new Array(DESKTOP_TOTAL_FRAMES + 1);
        let framePosition = 1.0;
        let playing = false;
        let timer = null;

        function pathFor(i){
          return `${DESKTOP_FOLDER}/${DESKTOP_PREFIX}${String(i).padStart(DESKTOP_PAD,'0')}${DESKTOP_EXT}`;
        }

        function show(pos){
          const index = Math.max(1, Math.min(DESKTOP_TOTAL_FRAMES, Math.floor(pos)));
          framePosition = pos;
          screenEl.textContent = frames[index] || '';
          if (screenFitHandle && typeof screenFitHandle.update === 'function') {
            screenFitHandle.update();
          }
        }

        function step(){
          let next = framePosition + DESKTOP_SPEED;
          if (next > DESKTOP_TOTAL_FRAMES) next = 1;
          show(next);
        }

        function startAnimation(){
          if (!playing) return;
          const interval = 1000 / DESKTOP_FPS;
          let expected = performance.now() + interval;

          function tick(){
            if (!playing || document.hidden) return;
            const now = performance.now();
            const drift = now - expected;
            if (drift >= 0) {
              step();
              expected += interval;
            }
            timer = setTimeout(tick, Math.max(0, interval - drift));
          }

          tick();
        }

        function play(){
          if (playing) return;
          playing = true;
          startAnimation();
        }

        function stopTimer(){
          if (timer) {
            clearTimeout(timer);
            timer = null;
          }
        }

        function handleVisibility(){
          if (document.hidden) {
            stopTimer();
          } else if (playing) {
            startAnimation();
          }
        }

        document.addEventListener('visibilitychange', handleVisibility);

        async function preload(){
                   const tasks = [];
          for (let i = 1; i <= DESKTOP_TOTAL_FRAMES; i++){
            tasks.push(
              fetch(pathFor(i))
                .then(r => { if (!r.ok) throw new Error(`HTTP ${r.status}`); return r.text(); })
                .then(txt => { frames[i] = txt; })
                .catch(err => { frames[i] = `âš  Failed to load ${pathFor(i)}\n${String(err)}`; })
            );
          }
          await Promise.all(tasks);
          screenEl.textContent = frames[1] || '(empty)';
          if (!screenFitHandle && window.asciiFit) {
            screenFitHandle = window.asciiFit.apply(screenEl, { onResize: true });
          } else if (screenFitHandle && typeof screenFitHandle.update === 'function') {
            screenFitHandle.update();
          }
          framePosition = 1.0;
          play();

        }

        preload();

        return {
          stop(){
            playing = false;
            stopTimer();
            document.removeEventListener('visibilitychange', handleVisibility);
          }
        };
      }

      function ensureDesktop(){
        if (!desktopCtrl) {
          desktopCtrl = initDesktopAnimation();
        }
      }

      function deactivateDesktop(){
        if (desktopCtrl && typeof desktopCtrl.stop === 'function') {
          desktopCtrl.stop();
          desktopCtrl = null;
        }
      }

      function applyMode(){
        if (mobileQuery.matches) {
          // Mobile: disable desktop ASCII animation
          deactivateDesktop();
        } else {
          // Desktop: enable desktop ASCII animation
          ensureDesktop();
        }
      }

      applyMode();

      if (typeof mobileQuery.addEventListener === 'function') {
        mobileQuery.addEventListener('change', applyMode);
      } else if (typeof mobileQuery.addListener === 'function') {
        mobileQuery.addListener(applyMode);
      }
    })();
  </script>
  <script src="/projects/ascii-fit.js"></script>
</body>
</html>
