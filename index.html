<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BMERCER.XYZ</title>
  <style>
    :root{
      color-scheme: dark;
      --bg:#0b0b10;--fg:#eaeaea;--muted:#8a8f98;--accent:#68c1ff;--card:#141518;--border:#26282d;
    }
    html,body{height:100%; overflow:hidden;}
    body{margin:0;background:var(--bg);color:var(--fg);font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;display:flex;flex-direction:column;}
    #banner{padding:60px; text-align:center; }
    .screen-wrap{flex:1; overflow:hidden; display:flex; align-items:center; justify-content:center;}
    pre#screen{margin:0; padding:16px; white-space:pre; line-height:1.05; font-size:8px; tab-size:2; text-align:center; display:inline-block; vertical-align:middle;}
    
    /* Responsive font scaling for smaller screens */
    @media (max-width: 1920px) {
      pre#screen { font-size: 3px; }
      #banner { display: none; }
    }
    @media (max-width: 1600px) {
      pre#screen { font-size: 2px; }
    }
    @media (max-width: 1200px) {
      pre#screen { font-size: 2px; }
    }
    @media (max-width: 1000px) {
      pre#screen { font-size: 2px; }
    }
    @media (max-width: 800px) {
      pre#screen { font-size: 1.5px; }
    }
    @media (max-width: 600px) {
      pre#screen { font-size: 1.5px; }
    }
    @media (max-width: 400px) {
      pre#screen { font-size: 1.5px; }
    }
  </style>
</head>
<body>


  <div id="banner">
    __/\\\\\\\\\\\\\____/\\\\____________/\\\\__/\\\\\\\\\\\\\\\____/\\\\\\\\\____________/\\\\\\\\\__/\\\\\\\\\\\\\\\____/\\\\\\\\\____________/\\\_______/\\\__/\\\________/\\\__/\\\\\\\\\\\\\\\_        
 _\/\\\/////////\\\_\/\\\\\\________/\\\\\\_\/\\\///////////___/\\\///////\\\_______/\\\////////__\/\\\///////////___/\\\///////\\\_________\///\\\___/\\\/__\///\\\____/\\\/__\////////////\\\__       
  _\/\\\_______\/\\\_\/\\\//\\\____/\\\//\\\_\/\\\_____________\/\\\_____\/\\\_____/\\\/___________\/\\\_____________\/\\\_____\/\\\___________\///\\\\\\/______\///\\\/\\\/______________/\\\/___      
   _\/\\\\\\\\\\\\\\__\/\\\\///\\\/\\\/_\/\\\_\/\\\\\\\\\\\_____\/\\\\\\\\\\\/_____/\\\_____________\/\\\\\\\\\\\_____\/\\\\\\\\\\\/______________\//\\\\__________\///\\\/______________/\\\/_____     
    _\/\\\/////////\\\_\/\\\__\///\\\/___\/\\\_\/\\\///////______\/\\\//////\\\____\/\\\_____________\/\\\///////______\/\\\//////\\\_______________\/\\\\____________\/\\\_____________/\\\/_______    
     _\/\\\_______\/\\\_\/\\\____\///_____\/\\\_\/\\\_____________\/\\\____\//\\\___\//\\\____________\/\\\_____________\/\\\____\//\\\______________/\\\\\\___________\/\\\___________/\\\/_________   
      _\/\\\_______\/\\\_\/\\\_____________\/\\\_\/\\\_____________\/\\\_____\//\\\___\///\\\__________\/\\\_____________\/\\\_____\//\\\___________/\\\////\\\_________\/\\\_________/\\\/___________  
       _\/\\\\\\\\\\\\\/__\/\\\_____________\/\\\_\/\\\\\\\\\\\\\\\_\/\\\______\//\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\_\/\\\______\//\\\__/\\\__/\\\/___\///\\\_______\/\\\________/\\\\\\\\\\\\\\\_ 
        _\/////////////____\///______________\///__\///////////////__\///________\///________\/////////__\///////////////__\///________\///__\///__\///_______\///________\///________\///////////////__

  </div>
  
  <div class="screen-wrap">
    <pre id="screen">Loading ASCII frames…</pre>
  </div>



  <script>
    // ==== CONFIG ====
    const TOTAL_FRAMES = 300;        // number of frames to play
    const FPS = 60;                  // target frames per second
    const SPEED = 0.5;               // animation speed multiplier (1.0 = normal, 0.5 = half speed, 2.0 = double speed)
    const FOLDER = 'ACII-Frames';    // folder containing the .txt files
    const PREFIX = '';         // filename prefix: frame_0001.txt
    const PAD = 4;                   // zero-padding digits
    const EXT = '.txt';              // file extension for frames

    // allow overriding via URL, e.g. ?fps=12
    const params = new URLSearchParams(location.search);
    const fps = Number(params.get('fps') || FPS);

    // DOM refs
    const screenEl = document.getElementById('screen');

    // Font size is now handled by CSS media queries for responsiveness

    // state
    let frames = new Array(TOTAL_FRAMES + 1); // 1-indexed for simplicity
    let loaded = 0;
    let playing = false;
    let frameIndex = 1;
    let framePosition = 1.0; // decimal position for smooth speed control
    let timer = null;
    let lastTime = 0; // track last update time

    function pathFor(i){
      return `${FOLDER}/${PREFIX}${String(i).padStart(PAD,'0')}${EXT}`;
    }


    async function preload(){
      const tasks = [];
      for(let i=1;i<=TOTAL_FRAMES;i++){
        tasks.push(
          fetch(pathFor(i))
            .then(r=>{ if(!r.ok) throw new Error(`HTTP ${r.status}`); return r.text(); })
            .then(txt=>{ frames[i] = txt; loaded++; })
            .catch(err=>{ frames[i] = `⚠ Failed to load ${pathFor(i)}\n${err}`; loaded++; })
        );
      }
      await Promise.all(tasks);
      screenEl.textContent = frames[1] || '(empty)';
      framePosition = 1.0;
      play();
    }

    function show(i){
      frameIndex = Math.floor(i);
      framePosition = i;
      screenEl.textContent = frames[frameIndex] || '';
    }

    function step(){
      const speed = 0.5; // Fixed speed at 0.5
      let next = framePosition + speed;
      
      if(next > TOTAL_FRAMES){
        next = 1; // Always loop
      }
      show(next);
    }

    function play(){
      if(playing) return;
      playing = true;
      startAnimation();
    }

    function startAnimation(){
      if(!playing) return;
      const interval = 1000 / fps;
      let expected = performance.now() + interval;
      
      function tick(){
        if(!playing || document.hidden) return;
        
        const now = performance.now();
        const dt = now - expected;
        if(dt >= 0){ 
          step(); 
          expected += interval; 
        }
        timer = setTimeout(tick, Math.max(0, interval - dt));
      }
      tick();
    }

    function pause(){
      playing = false;
      if(timer) clearTimeout(timer);
    }

    // Handle tab visibility changes
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        // Tab became hidden - stop the animation completely
        if(timer) {
          clearTimeout(timer);
          timer = null;
        }
      } else if (playing) {
        // Tab became visible again - restart animation cleanly
        startAnimation();
      }
    });

    // start
    preload();
  </script>
</body>
</html>
